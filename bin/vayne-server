#!/usr/bin/env node
const {join} = require('path')
// const spawn = require('cross-spawn')
const {fork} = require('child_process')

if (!process.env.NODE_ENV) {
  process.env.NODE_ENV = 'development'
}

function start () {
  const p = fork(join(__dirname, '../lib/config/server.js'), process.argv.slice(2))
  p.on('message', (data) => {
    if (data === 'RESTART') {
      p.kill('SIGINT')
      start()
    }
  })
}

start()
